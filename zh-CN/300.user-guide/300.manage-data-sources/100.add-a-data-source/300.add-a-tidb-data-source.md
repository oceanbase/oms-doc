# 添加 TiDB 数据源

配置好数据源是创建数据迁移项目的前提。启动数据迁移项目前，您必须添加 TiDB 数据库作为数据源。本文为您介绍如何在 OceanBase 迁移服务（OceanBase Migration Service，OMS）社区版添加 TiDB 数据源。

## 前提条件

* 已获取相关数据库的 IP 地址和端口号。

* 已存在用于数据迁移的数据库用户。

  建议您为数据迁移项目创建一个专属的数据库用户，该用户必须具备相关的数据操作权限。详情请参见 [用户权限说明](../../200.users-and-privileges/200.user-privileges.md)。
  
* 如果您需要订阅 TiDB 增量日志，请准备 Kafka 数据源和 Kafka Topic。并且，请根据 [TiDB 官方文档](https://docs.pingcap.com/zh/tidb/dev/ticdc-manage-changefeed)，提前创建 TiDB 数据库至 Kafka 的链路。

  >**注意：**
  >
  >您在 TiDB 数据库中配置的待订阅库表，需要和 OMS 社区版数据迁移项目中配置的库表名保持一致。

## 操作步骤

1. 登录 OMS 社区版控制台。

2. 在左侧导航栏，单击 **数据源管理**。

3. 在 **数据源管理** 页面，单击右上角的 **添加数据源**。

4. 在 **添加数据源** 对话框，选择 **数据源类型** 为 **TiDB**。

5. 配置各项参数。

   |    **参数**    |                               **描述**                                                        |
   |--------------|--------------------------------------------------------|
   | 数据源标识        | 建议使用中文、数字和字母的组合。名称中不能包含空格，长度不得超过 32 个字符。                                                                                                                                                                    |
   | 地域           | 从下拉列表中选择数据源所属的地域（即部署 OMS 社区版时配置的 `cm_region` 参数）。 <br>**注意：** <ul><li> 仅多地域场景下会显示该参数。   <li> 请确保数据源与地域的映射关系保持一致，否则可能导致迁移同步性能较差。 </ul>                          |
   | 主机 IP        | TiDB 角色节点 IP。                                                                                                                                                                                                                                              |
   | 端口           | TiDB 角色节点 IP 的端口号。                                                                                                                                                                                                                                         |
   | 用户名          | 用于数据迁移的 TiDB 数据库的用户名称。                                                                                                                                                                                                                                |
   | 密码           | 数据库用户的密码。                                                                                                                                                                                                                                                  |
   | DB Name（可选）  | TiDB 数据库的名称。                                                                                                                                                                                                                                               |
   | 绑定 Kafka 数据源 | Kafka 提供 OMS 社区版获取 TiDB 增量日志的能力。 <ul><li>如果勾选该项，请在下拉列表中选择需要绑定的 **Kafka 数据源** 及其 **Topic**。   <li> 如果未勾选该项，创建 TiDB 数据库至 OceanBase 社区版的数据迁移项目时，无法选择增量迁移。    |
   | 备注（可选）       | 数据源的备注信息。                                                                                                                                                                                                                                                  |

6. 单击 **测试连接**，验证 OMS 社区版和数据库的网络连接，以及用户名和密码的有效性。

7. 测试连接通过后，单击 **添加**。
