# 查看和修改迁移对象

本文为您介绍如何在 OceanBase 迁移服务（OceanBase Migration Service，OMS）社区版中查看和修改已配置的数据迁移项目的迁移对象。

## 背景信息

数据迁移项目在迁移过程中，满足限制条件的情况下，您可以增加或减少迁移对象。每一次运行的修改行为都会被记录。当增加对象任务执行完成后，会与关联的原项目合并。合并成功后，原项目正常运行，增加对象任务会自动释放。

## 使用限制

* 仅通过 **指定对象** 方式选择迁移对象的数据迁移项目，支持修改迁移对象。

* 数据迁移项目处于 **未启动**、**运行中** 或 **已暂停** 状态时，支持增加和减少迁移对象。

* 数据迁移项目处于 **失败** 状态时，仅支持减少迁移对象。

* 数据迁移项目处于 **修改中** 或 **合并中** 状态时，不支持再次修改迁移对象。|

* 数据迁移项目的 **全量迁移**、**增量同步** 步骤处于 **暂停** 或 **失败** 状态时，仅支持减少迁移对象。

* 数据迁移项目处于 **反向增量** 步骤时，仅支持减少迁移对象。

## 查看迁移对象

1. 登录 OMS 社区版控制台。

2. 在左侧导航栏，单击 **数据迁移**。

3. 在 **数据迁移** 页面，单击目标项目的名称，进入该项目的详情页面。

4. 单击页面右上角的 **查看对象**，查看 **迁移对象** 和 **修改对象记录**。

   * **迁移对象** 页签为您展示当前项目的迁移对象，您还可以单击 **修改对象**，进行 **增加对象** 和 **减少对象** 操作。

   * **修改对象记录** 页签为您展示所有修改对象操作的 ID、修改类型、状态和修改时间等信息。

## 增加迁移对象

1. 在目标项目的详情页面，单击右上角的 **查看对象**。

2. 在 **查看对象** 对话框，单击 **修改对象** \> **增加对象**。

3. 在 **增加对象** 对话框的左侧 **源端对象** 区域，选中需要迁移的对象，单击 **\>**，将其添加至右侧列表中。您可以选择一个或多个库的表、视图作为迁移对象。

   选择增加的迁移对象后，您可以进行重命名对象名称、设置行过滤和查看列信息等操作。

   <main id="notice" type='notice'>
    <h4>注意</h4>
    <ul>
    <li>
    <p>增加对象将默认继承原数据迁移项目的全部配置选项。如果增加对象的过程中终止了操作，您需要手动删除目标库中已增加的对象。</p>
    </li>
    <li>
    <p>如果源端数据源配置了 Schema Name 或 DB Name，则仅支持增加指定 Schema Name 或 DB Name 下的迁移对象。</p>
    </li>
    </ul>
   </main>

4. 选择完成后，单击 **下一步**。

5. 系统会自动对增加对象执行预检查。全部检查项目均通过后，单击 **保存**。

6. 确认无误后，在弹出框单击 **确定**。

   * 如果项目处于已暂停或失败状态，您可以取消后重新进行修改。修改后，请先恢复数据迁移项目，才能够执行增加对象操作。

   * 如果项目处于运行中状态，单击保存后，将立即执行增加项目操作。
  
   增加对象操作开始执行后，会在 **查看对象** \> **修改对象记录** 页面生成记录，您可以进入该页面查看记录的详情。增加对象记录的状态包括 **待执行**、**已取消**、**修改中**、**运行中**、**已终止**、**合并中**、**成功** 和 **失败**，不同状态的增加对象记录支持的操作，以及处于运行中状态的原项目对应的状态也不同。

    <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>原项目处于 <strong>未启动</strong> 状态时，增加对象会生成一条 <strong>成功</strong> 状态的修改记录。原项目处于 <strong>已暂停</strong> 状态时，增加对象会生成一条 <strong>待执行</strong> 状态的修改记录。</p>
    </main>

   只有原项目处于运行中的状态，增加对象记录的状态才会被推进。增加对象记录的状态推进后，原项目状态也随之更新。详情请参见下表。

   | **增加对象记录的状态** | **支持的操作**                                                    | **原项目对应的状态** |
   |---------------|--------------------------------------------------------------|------------|
   | 待执行           | 查看详情、取消                                                      | 运行中        |
   | 已取消           |  无                                                            |  运行中  |
   | 修改中           | 无                                                          | 修改中       |
   | 运行中           | 查看详情、终止                                                      | 修改中        |
   | 已终止           | 查看详情                                                         | 运行中        |
   | 合并中           | 查看详情                                                         | 合并中        |
   | 成功            | 查看详情                         | 运行中        |
   | 失败            | 查看详情、重试 <br>您还可以单击 **查看原因**，跳转至任务的详情页面，查看失败的原因。 | 修改中/合并中       |

## 减少迁移对象

1. 在目标项目的详情页面，单击右上角的 **查看对象**。

2. 在 **查看对象** 对话框，单击 **修改对象** \> **减少对象**。

3. 在 **减少对象** 对话框的右侧 **目标端对象** 区域，鼠标悬停至需要减少迁移的对象，单击 **移除**。

4. 在 **减少对象** 对话框，单击 **移除**。

5. 在弹出框中确认需要移除的对象无误后，单击 **确定**。

   如果项目处于已暂停、失败或运行中状态，单击确定后，将立即执行减少对象操作。

    <main id="notice" type='notice'>
    <h4>注意</h4>
    <ul>
    <li>
    <p>对象减少后不可恢复，请谨慎操作。</p>
    </li>
    <li>
    <p>减少对象操作最终是全部成功或全部失败。</p>
    </li>
    </ul>
    </main>

   减少对象操作开始执行后，会在 **查看对象** \> **修改对象记录** 页面生成记录，您可以进入该页面查看记录的详情。减少对象记录的状态包括 **待执行**、**已取消**、**修改中**、**成功** 和 **失败**，不同状态的修改对象记录支持的操作，以及处于运行中状态的原项目对应的状态也不同。

   | **减少对象记录的状态** | **支持的操作**                                                    | **原项目对应的状态** |
   |---------------|--------------------------------------------------------------|------------|
   | 待执行           | 查看详情、取消                                                      | 运行中        |
   | 已取消           |  无                                                            |  运行中  |
   | 修改中           | 无                                                          | 修改中       |
   | 成功            | 查看详情                         | 运行中        |
   | 失败            | 查看详情、重试 <br>您还可以单击 **查看原因**，跳转至任务的详情页面，查看失败的原因。 | 修改中      |
